Final Version of Working Code 